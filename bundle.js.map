{
  "version": 3,
  "sources": [
    "..\\Users\\cheahshen\\AppData\\Roaming\\npm\\node_modules\\ksana-cli\\node_modules\\browserify\\node_modules\\browser-pack\\_prelude.js",
    "node_modules\\ksana2015-treetoc\\controls.js",
    "node_modules\\ksana2015-treetoc\\index.js",
    "node_modules\\ksana2015-treetoc\\manipulate.js",
    "node_modules\\ksana2015-treetoc\\treenode.js",
    "node_modules\\ksana2015-webruntime\\checkbrowser.js",
    "node_modules\\ksana2015-webruntime\\downloader.js",
    "node_modules\\ksana2015-webruntime\\fileinstaller.js",
    "node_modules\\ksana2015-webruntime\\html5fs.js",
    "node_modules\\ksana2015-webruntime\\htmlfs.js",
    "node_modules\\ksana2015-webruntime\\index.js",
    "node_modules\\ksana2015-webruntime\\installkdb.js",
    "node_modules\\ksana2015-webruntime\\kfs.js",
    "node_modules\\ksana2015-webruntime\\kfs_html5.js",
    "node_modules\\ksana2015-webruntime\\ksanagap.js",
    "node_modules\\ksana2015-webruntime\\livereload.js",
    "node_modules\\ksana2015-webruntime\\liveupdate.js",
    "node_modules\\ksana2015-webruntime\\mkdirp.js",
    "treetoc-sample\\index.js",
    "treetoc-sample\\src\\jwl-toc.js",
    "treetoc-sample\\src\\main.jsx"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;;ACLA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "var React=require(\"react\");\r\nvar E=React.createElement;\r\n\r\nvar Controls=React.createClass({\r\n\tpropTypes:{\r\n\t\tenabled:React.PropTypes.array.isRequired\r\n\t\t,action:React.PropTypes.func.isRequired\r\n\t}\r\n\t,getDefaultProps:function(){\r\n\t\treturn {enabled:[]};\r\n\t}\r\n\t,enb:function(name) {\r\n\t\treturn this.props.enabled.indexOf(name)===-1;\t\t\r\n\t}\r\n\t,act:function(name) {\r\n\t\tvar that=this;\r\n\t\treturn function(){\r\n\t\t\tthat.props.action(name);\r\n\t\t}\r\n\t}\r\n\t,render:function() {\r\n\t\treturn E(\"div\",{},\r\n\t\t\tE(\"button\" ,{onClick:this.act(\"add\"),title:\"New Node\",disabled:this.enb(\"add\")},\"＋\"),\r\n\t\t\tE(\"button\"　,{onClick:this.act(\"remove\"),title:\"remove Node\",disabled:this.enb(\"remove\")},\"－\"),\r\n\t\t\tE(\"button\" ,{onClick:this.act(\"moveup\"),title:\"Move up\",disabled:this.enb(\"moveup\")},\"⇧\"),\r\n\t\t\tE(\"button\" ,{onClick:this.act(\"movedown\"),title:\"Move down\",disabled:this.enb(\"movedown\")},\"⇩\"),\r\n\t\t\tE(\"button\" ,{onClick:this.act(\"levelup\"),title:\"level -1\",disabled:this.enb(\"levelup\")},\"⇠\"),\r\n\t\t\tE(\"button\" ,{onClick:this.act(\"leveldown\"),title:\"level +1\",disabled:this.enb(\"leveldown\")},\"⇢\")\r\n\t\t);\r\n\t}\r\n})\r\n\r\nmodule.exports=Controls;",
    "/*\r\n   toc data format\r\n   array of { d:depth, o:opened, t:text, n:next_same_level ]\r\n\r\n   only first level can be 0\r\n*/\r\nvar React=require(\"react\");\r\nvar TreeNode=require(\"./treenode\");\r\nvar Controls=require(\"./controls\");\r\nvar E=React.createElement;\r\nvar manipulate=require(\"./manipulate\");\r\n\r\nvar buildToc = function(toc) {\r\n\tif (!toc || !toc.length) return;  \r\n\tvar depths=[];\r\n \tvar prev=0;\r\n \tif (toc.length>1) {\r\n \t\ttoc[0].o=true;//opened\r\n \t}\r\n \tfor (var i=0;i<toc.length;i++) delete toc[i].n;\r\n\tfor (var i=0;i<toc.length;i++) {\r\n\t    var depth=toc[i].d||toc[i].depth;\r\n\t    if (prev>depth) { //link to prev sibling\r\n\t      if (depths[depth]) toc[depths[depth]].n = i;\r\n\t      for (var j=depth;j<prev;j++) depths[j]=0;\r\n\t    }\r\n    \tdepths[depth]=i;\r\n    \tprev=depth;\r\n\t}\r\n}\r\nvar genToc=function(toc,title) {\r\n    var out=[{depth:0,text:title||ksana.js.title}];\r\n    if (toc.texts) for (var i=0;i<toc.texts.length;i++) {\r\n      out.push({t:toc.texts[i],d:toc.depths[i], voff:toc.vpos[i]});\r\n    }\r\n    return out; \r\n}\r\nvar TreeToc=React.createClass({\r\n\tpropTypes:{\r\n\t\tdata:React.PropTypes.array.isRequired\r\n\t\t,opts:React.PropTypes.object\r\n\t}\r\n\t,getInitialState:function(){\r\n\t\treturn {editcaption:-1,selected:[],enabled:[]};\r\n\t}\r\n\t,action:function() {\r\n\t\tvar args=Array.prototype.slice.apply(arguments);\r\n\t\tvar act=args.shift();\r\n\t\tvar p1=args[0];\r\n\t\tvar p2=args[1];\r\n\t\tvar firstsel=this.state.selected[0];\r\n\t\tvar toc=this.props.data;\r\n\t\tvar r=false;\r\n\t\tif (act===\"updateall\") {\r\n\t\t\tthis.setState({editcaption:-1});\r\n\t\t} else if (act===\"editcaption\") {\r\n\t\t\tthis.setState({editcaption:parseInt(p1),enabled:[]});\r\n\t\t} else if (act===\"changecaption\") {\r\n\t\t\tif (!this.state.editcaption===-1) return;\r\n\t\t\tthis.props.data[this.state.editcaption].t=p1;\r\n\t\t\tvar enabled=manipulate.enabled(this.state.selected,this.props.data);\r\n\t\t\tthis.setState({editcaption:-1,enabled:enabled});\r\n\t\t} else if (act===\"select\") {\r\n\t\t\tvar selected=this.state.selected;\r\n\t\t\tif (!(this.props.opts.multiselect && p2)) {\r\n\t\t\t\tselected=[];\r\n\t\t\t}\r\n\t\t\tvar n=parseInt(p1);\r\n\t\t\tif (n>0) selected.push(n);\r\n\t\t\tvar enabled=manipulate.enabled(selected,toc);\r\n\t\t\tthis.setState({selected:selected,editcaption:-1,enabled:enabled});\r\n\t\t} else if (act===\"levelup\") r=manipulate.levelup(this.state.selected,toc);\r\n\t\telse if (act===\"leveldown\") r=manipulate.leveldown(this.state.selected,toc);\r\n\t\telse if (act===\"moveup\") r=manipulate.moveup(firstsel,toc);\r\n\t\telse if (act===\"movedown\") r=manipulate.movedown(firstsel,toc);\r\n\t\telse if (act===\"add\") r=manipulate.addnode(firstsel,toc);\r\n\t\telse if (act===\"remove\") r=manipulate.removenode(firstsel,toc);\r\n\t\tif (r) {\r\n\t\t\tbuildToc(toc);\r\n\t\t\tvar enabled=manipulate.enabled(this.state.selected,this.props.data);\r\n\t\t\tthis.setState({enabled:enabled});\r\n\t\t}\r\n\t}\r\n\t,render:function() {\r\n\t\tvar controls=null;\r\n\t\tif (this.props.opts.editable) controls=E(Controls,{action:this.action,enabled:this.state.enabled});\r\n\t\treturn E(\"div\",{},controls,\r\n\t\t\tE(TreeNode,{data:this.props.data,\r\n\t\t\t\teditcaption:this.state.editcaption,\r\n\t\t\t\tselected:this.state.selected,\r\n\t\t\t\taction:this.action,opts:this.props.opts,cur:0}));\r\n\t}\r\n})\r\nmodule.exports={component:TreeToc,genToc:genToc,buildToc:buildToc};",
    "var lastChild=function(n,toc) {\r\n\tvar d=toc[n].d;\r\n\tn++;\r\n\twhile (n<toc.length) {\r\n\t\tif (toc[n].d<=d) return n;\r\n\t\tn++;\r\n\t}\r\n\treturn toc.length-1;\r\n}\r\nvar levelup =function(sels,toc) { //move select node and descendants one level up\r\n\tif (!canLevelup(sels,toc))return;\r\n\tvar n=sels[0];\r\n\tvar cur=toc[n];\r\n\tvar next=toc[n+1];\r\n\tvar nextsib=cur.n||lastChild(n,toc);\r\n\tif (next && next.d>cur.d) { //has child\r\n\t\tfor (var i=n+1;i<nextsib;i++) {\r\n\t\t\ttoc[i].d--;\r\n\t\t}\r\n\t}\r\n\tcur.d--;\r\n\tcur.o=true;//force open this node , so that sibling is visible\r\n\treturn true;\r\n}\r\nvar leveldown =function(sels,toc) {\r\n\tif (!canLeveldown(sels,toc))return; //move select node and descendants one level down\r\n\tvar n=sels[0];\r\n\tvar cur=toc[n];\r\n\tvar next=toc[n+1];\r\n\r\n\t//force open previous node as it becomes parent of this node\r\n\tvar p=prevSibling(n,toc);\r\n\tif (p) toc[p].o=true;\r\n\r\n\tif (next && next.d>cur.d) { //has child\r\n\t\tfor (var i=n+1;i<cur.n;i++) {\r\n\t\t\ttoc[i].d++;\r\n\t\t}\r\n\t}\r\n\tcur.d++;\r\n\treturn true;\r\n}\r\nvar moveup =function(sel,toc) {\r\n\t\r\n}\r\nvar movedown =function(sel,toc) {\r\n\t\r\n}\r\nvar add =function(sel,toc) {\r\n\t\r\n}\r\nvar remove =function(sel,toc) {\r\n\t\r\n}\r\nvar canAdd=function(sels,toc) {\r\n}\r\nvar canRemove=function(sels,toc) {\r\n}\r\nvar canMoveup=function(sels,toc) {\r\n}\r\nvar canMovedown=function(sels,toc) {\r\n}\r\nvar canLevelup=function(sels,toc) {\r\n\tif (sels.length==0) return false;\r\n\tvar n=sels[0];\r\n\treturn (sels.length==1 && toc[n].d>1);\r\n}\r\nvar prevSibling=function(n,toc) {\r\n\tvar p=n-1;\r\n\tvar d=toc[n].d;\r\n\twhile (p>0) {\r\n\t\tif (toc[p].d<d) return 0;\r\n\t\tif (toc[p].d==d) return p;\r\n\t\tp--;\r\n\t}\r\n}\r\nvar canLeveldown=function(sels,toc) {\r\n\tif (sels.length==0) return false;\r\n\tvar n=sels[0];\r\n\treturn (sels.length==1 && prevSibling(n,toc));\r\n}\r\nvar enabled=function(sels,toc) {\r\n\tvar enabled=[];\r\n\tif (canLeveldown(sels,toc)) enabled.push(\"leveldown\");\r\n\tif (canLevelup(sels,toc)) enabled.push(\"levelup\");\r\n\tif (canMoveup(sels,toc)) enabled.push(\"moveup\");\r\n\tif (canMovedown(sels,toc)) enabled.push(\"movedown\");\r\n\tif (canAdd(sels,toc)) enabled.push(\"add\");\r\n\tif (canRemove(sels,toc)) enabled.push(\"remove\");\r\n\treturn enabled;\r\n}\r\nmodule.exports={enabled:enabled,levelup:levelup,leveldown:leveldown,moveup:moveup,movedown:movedown,add:add,remove:remove};",
    "var React=require(\"react\");\r\nvar E=React.createElement;\r\nvar TreeNode=React.createClass({\r\n\tpropTypes:{\r\n\t\tdata:React.PropTypes.array.isRequired\r\n\t\t,opts:React.PropTypes.object\r\n\t\t,action:React.PropTypes.func.isRequired\r\n\t\t,selected:React.PropTypes.array\r\n\t\t,cur:React.PropTypes.number.isRequired\r\n\t}\r\n\t,getInitialState:function() {\r\n\t\treturn {};\r\n\t}\r\n\t,getDefaultProps:function() {\r\n\t\treturn {cur:0,opts:{}};\r\n\t}\r\n\r\n\t,click:function(e) {\r\n\t\tvar n=parseInt(e.target.parentElement.attributes['data-n'].value);\r\n\t\tthis.props.data[n].o=!this.props.data[n].o;\r\n\t\tthis.forceUpdate();\r\n\t\te.preventDefault();\r\n        e.stopPropagation();\r\n\t}\r\n\t,select:function(e){\r\n\t\tvar datan=e.target.parentElement.attributes['data-n'];\r\n\t\tif (!datan) return;\r\n\t\tvar n=parseInt(datan.value);\r\n\t\tvar selected=this.props.selected.indexOf(n)>-1;\r\n\t\tif (selected && this.props.opts.editable) {\r\n\t\t\tthis.props.action(\"editcaption\",n);\r\n\t\t} else {\r\n\t\t\tthis.props.action(\"select\",n,e.ctrlKey);\r\n\t\t}\r\n\t\te.preventDefault();\r\n        e.stopPropagation();\r\n\t}\r\n\t,componentDidUpdate:function() {\r\n\t\tif (this.refs.editcaption) {\r\n\t\t\tvar dom=this.refs.editcaption.getDOMNode();\r\n\t\t\tdom.focus();\r\n\t\t\tdom.selectionStart=dom.value.length;\r\n\t\t}\r\n\t}\r\n\t,keypress:function(e) {\r\n\t\tif (e.key==\"Enter\") {\r\n\t\t\tthis.props.action(\"changecaption\",e.target.value);\t\r\n\t\t}\r\n\t}\r\n\t,renderItem:function(e,idx){\r\n\t\tvar t=this.props.data[e];\r\n\t\treturn E(TreeNode,{key:\"k\"+idx,cur:e,\r\n\t\t\teditcaption:this.props.editcaption,selected:this.props.selected,\r\n\t\t\taction:this.props.action,data:this.props.data,opts:this.props.opts});\r\n\t}\r\n\t,render:function() {\r\n\t\tvar n=this.props.cur;\r\n\t\tvar cur=this.props.data[n];\r\n\t\tvar next=this.props.data[n+1];\r\n\t\tvar selected=\"\",extra=\"\",children=[];\r\n\t\tvar folderbutton=null;\r\n\t\tvar depthdeco=renderDepth(cur.d,this.props.opts)\r\n\t\tif (cur.d==0) extra=\" treetoc\";\r\n\t\tif (this.props.selected.indexOf(n)>-1) selected=\" selected\";\r\n\t\tif (next && next.d>cur.d) { \r\n\t\t\tif (cur.o) {\r\n\t\t\t\tchildren=enumChildren(this.props.data,n);\r\n\t\t\t\tfolderbutton=E(\"a\",{className:\"folderbutton opened\",onClick:this.click},\"－\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfolderbutton=E(\"a\",{className:\"folderbutton closed\",onClick:this.click},\"＋\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfolderbutton=E(\"a\",{ className:\"leaf\", \"style\":{\"visibility\":\"hidden\"} },\"　\");\r\n\t\t}\r\n\r\n\t\tvar extracomponent=this.props.opts.onNode&& this.props.opts.onNode(cur);\r\n\t\tvar caption=E(\"span\",{className:selected+\" caption\",title:n},cur.t);\r\n\t\tif (this.props.editcaption===n) {\r\n\t\t\tcaption=E(\"input\",{onKeyPress:this.keypress,className:\"\",ref:\"editcaption\",defaultValue:cur.t});\r\n\t\t\textracomponent=null;\r\n\t\t}\r\n\r\n\t\treturn E(\"div\",{onClick:this.select,\"data-n\":n,className:\"childnode\"+extra},\r\n\t\t\t   folderbutton,depthdeco,\r\n\t\t\t   caption,\r\n\t\t\t   extracomponent,\r\n\t\t\t   \tchildren.map(this.renderItem));\r\n\t}\r\n});\r\n\r\nvar ganzhi=\"　甲乙丙丁戊己庚辛壬癸子丑寅卯辰巳午未申酉戌亥\";\r\n\r\nvar renderDepth=function(depth,opts) {\r\n  var out=[];\r\n  if (opts&&opts.tocstyle==\"ganzhi\") {\r\n    return E(\"span\", null, ganzhi[depth].trim()+\" \");\r\n  } else {\r\n    if (depth) return E(\"span\", null, depth, \".\")\r\n    else return null;\r\n  }\r\n  return null;\r\n};\r\n\r\n\r\nvar enumChildren=function(toc,cur) {\r\n    var children=[];\r\n    if (!toc || !toc.length || toc.length==1) return children;\r\n    thisdepth=toc[cur].d||toc[cur].depth;\r\n    if (cur==0) thisdepth=0;\r\n    if (cur+1>=toc.length) return children;\r\n    if ((toc[cur+1].d||toc[cur+1].depth)!= 1+thisdepth) {\r\n    \treturn children;  // no children node\r\n    }\r\n    var n=cur+1;\r\n    var child=toc[n];\r\n    \r\n    while (child) {\r\n      children.push(n);\r\n      var next=toc[n+1];\r\n      if (!next) break;\r\n      if ((next.d||next.depth)==(child.d||child.depth)) {\r\n        n++;\r\n      } else if ((next.d||next.depth)>(child.d||child.depth)) {\r\n        n=child.n||child.next;\r\n      } else break;\r\n      if (n) child=toc[n];else break;\r\n    }\r\n    return children;\r\n}\r\nmodule.exports=TreeNode;",
    "/*\r\nconvert to pure js\r\nsave -g reactify\r\n*/\r\nvar React=(window&&window.React)||require(\"react\");\r\nvar E=React.createElement;\r\n\r\nvar hasksanagap=(typeof ksanagap!=\"undefined\");\r\nif (hasksanagap && (typeof console==\"undefined\" || typeof console.log==\"undefined\")) {\r\n\t\twindow.console={log:ksanagap.log,error:ksanagap.error,debug:ksanagap.debug,warn:ksanagap.warn};\r\n\t\tconsole.log(\"install console output funciton\");\r\n}\r\n\r\nvar checkfs=function() {\r\n\treturn (navigator && navigator.webkitPersistentStorage) || hasksanagap;\r\n}\r\nvar featurechecks={\r\n\t\"fs\":checkfs\r\n}\r\nvar checkbrowser = React.createClass({\r\n\tgetInitialState:function() {\r\n\r\n\t\tvar missingFeatures=this.getMissingFeatures();\r\n\t\treturn {ready:false, missing:missingFeatures};\r\n\t},\r\n\tgetMissingFeatures:function() {\r\n\t\tvar feature=this.props.feature.split(\",\");\r\n\t\tvar status=[];\r\n\t\tfeature.map(function(f){\r\n\t\t\tvar checker=featurechecks[f];\r\n\t\t\tif (checker) checker=checker();\r\n\t\t\tstatus.push([f,checker]);\r\n\t\t});\r\n\t\treturn status.filter(function(f){return !f[1]});\r\n\t},\r\n\tdownloadbrowser:function() {\r\n\t\twindow.location=\"https://www.google.com/chrome/\"\r\n\t},\r\n\trenderMissing:function() {\r\n\t\tvar showMissing=function(m) {\r\n\t\t\treturn E(\"div\", null, m);\r\n\t\t}\r\n\t\treturn (\r\n\t\t E(\"div\", {ref: \"dialog1\", className: \"modal fade\", \"data-backdrop\": \"static\"}, \r\n\t\t    E(\"div\", {className: \"modal-dialog\"}, \r\n\t\t      E(\"div\", {className: \"modal-content\"}, \r\n\t\t        E(\"div\", {className: \"modal-header\"}, \r\n\t\t          E(\"button\", {type: \"button\", className: \"close\", \"data-dismiss\": \"modal\", \"aria-hidden\": \"true\"}, \"×\"), \r\n\t\t          E(\"h4\", {className: \"modal-title\"}, \"Browser Check\")\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-body\"}, \r\n\t\t          E(\"p\", null, \"Sorry but the following feature is missing\"), \r\n\t\t          this.state.missing.map(showMissing)\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-footer\"}, \r\n\t\t          E(\"button\", {onClick: this.downloadbrowser, type: \"button\", className: \"btn btn-primary\"}, \"Download Google Chrome\")\r\n\t\t        )\r\n\t\t      )\r\n\t\t    )\r\n\t\t  )\r\n\t\t );\r\n\t},\r\n\trenderReady:function() {\r\n\t\treturn E(\"span\", null, \"browser ok\")\r\n\t},\r\n\trender:function(){\r\n\t\treturn  (this.state.missing.length)?this.renderMissing():this.renderReady();\r\n\t},\r\n\tcomponentDidMount:function() {\r\n\t\tif (!this.state.missing.length) {\r\n\t\t\tthis.props.onReady();\r\n\t\t} else {\r\n\t\t\t$(this.refs.dialog1.getDOMNode()).modal('show');\r\n\t\t}\r\n\t}\r\n});\r\n\r\nmodule.exports=checkbrowser;",
    "\r\nvar userCancel=false;\r\nvar files=[];\r\nvar totalDownloadByte=0;\r\nvar targetPath=\"\";\r\nvar tempPath=\"\";\r\nvar nfile=0;\r\nvar baseurl=\"\";\r\nvar result=\"\";\r\nvar downloading=false;\r\nvar startDownload=function(dbid,_baseurl,_files) { //return download id\r\n\tvar fs     = require(\"fs\");\r\n\tvar path   = require(\"path\");\r\n\r\n\t\r\n\tfiles=_files.split(\"\\uffff\");\r\n\tif (downloading) return false; //only one session\r\n\tuserCancel=false;\r\n\ttotalDownloadByte=0;\r\n\tnextFile();\r\n\tdownloading=true;\r\n\tbaseurl=_baseurl;\r\n\tif (baseurl[baseurl.length-1]!='/')baseurl+='/';\r\n\ttargetPath=ksanagap.rootPath+dbid+'/';\r\n\ttempPath=ksanagap.rootPath+\".tmp/\";\r\n\tresult=\"\";\r\n\treturn true;\r\n}\r\n\r\nvar nextFile=function() {\r\n\tsetTimeout(function(){\r\n\t\tif (nfile==files.length) {\r\n\t\t\tnfile++;\r\n\t\t\tendDownload();\r\n\t\t} else {\r\n\t\t\tdownloadFile(nfile++);\t\r\n\t\t}\r\n\t},100);\r\n}\r\n\r\nvar downloadFile=function(nfile) {\r\n\tvar url=baseurl+files[nfile];\r\n\tvar tmpfilename=tempPath+files[nfile];\r\n\tvar mkdirp = require(\"./mkdirp\");\r\n\tvar fs     = require(\"fs\");\r\n\tvar http   = require(\"http\");\r\n\r\n\tmkdirp.sync(path.dirname(tmpfilename));\r\n\tvar writeStream = fs.createWriteStream(tmpfilename);\r\n\tvar datalength=0;\r\n\tvar request = http.get(url, function(response) {\r\n\t\tresponse.on('data',function(chunk){\r\n\t\t\twriteStream.write(chunk);\r\n\t\t\ttotalDownloadByte+=chunk.length;\r\n\t\t\tif (userCancel) {\r\n\t\t\t\twriteStream.end();\r\n\t\t\t\tsetTimeout(function(){nextFile();},100);\r\n\t\t\t}\r\n\t\t});\r\n\t\tresponse.on(\"end\",function() {\r\n\t\t\twriteStream.end();\r\n\t\t\tsetTimeout(function(){nextFile();},100);\r\n\t\t});\r\n\t});\r\n}\r\n\r\nvar cancelDownload=function() {\r\n\tuserCancel=true;\r\n\tendDownload();\r\n}\r\nvar verify=function() {\r\n\treturn true;\r\n}\r\nvar endDownload=function() {\r\n\tnfile=files.length+1;//stop\r\n\tresult=\"cancelled\";\r\n\tdownloading=false;\r\n\tif (userCancel) return;\r\n\tvar fs     = require(\"fs\");\r\n\tvar mkdirp = require(\"./mkdirp\");\r\n\r\n\tfor (var i=0;i<files.length;i++) {\r\n\t\tvar targetfilename=targetPath+files[i];\r\n\t\tvar tmpfilename   =tempPath+files[i];\r\n\t\tmkdirp.sync(path.dirname(targetfilename));\r\n\t\tfs.renameSync(tmpfilename,targetfilename);\r\n\t}\r\n\tif (verify()) {\r\n\t\tresult=\"success\";\r\n\t} else {\r\n\t\tresult=\"error\";\r\n\t}\r\n}\r\n\r\nvar downloadedByte=function() {\r\n\treturn totalDownloadByte;\r\n}\r\nvar doneDownload=function() {\r\n\tif (nfile>files.length) return result;\r\n\telse return \"\";\r\n}\r\nvar downloadingFile=function() {\r\n\treturn nfile-1;\r\n}\r\n\r\nvar downloader={startDownload:startDownload, downloadedByte:downloadedByte,\r\n\tdownloadingFile:downloadingFile, cancelDownload:cancelDownload,doneDownload:doneDownload};\r\nmodule.exports=downloader;",
    "/* todo , optional kdb */\r\nvar React=(window&&window.React)||require(\"react\");\r\nvar HtmlFS=require(\"./htmlfs\");\r\nvar html5fs=require(\"./html5fs\");\r\nvar CheckBrowser=require(\"./checkbrowser\");\r\nvar E=React.createElement;\r\n  \r\n\r\nvar FileList = React.createClass({\r\n\tgetInitialState:function() {\r\n\t\treturn {downloading:false,progress:0};\r\n\t},\r\n\tupdatable:function(f) {\r\n        var classes=\"btn btn-warning\";\r\n        if (this.state.downloading) classes+=\" disabled\";\r\n\t\tif (f.hasUpdate) return   E(\"button\", {className: classes, \r\n\t\t\t\"data-filename\": f.filename, \"data-url\": f.url, \r\n\t            onClick: this.download\r\n\t       }, \"Update\")\r\n\t\telse return null;\r\n\t},\r\n\tshowLocal:function(f) {\r\n        var classes=\"btn btn-danger\";\r\n        if (this.state.downloading) classes+=\" disabled\";\r\n\t  return E(\"tr\", null, E(\"td\", null, f.filename), \r\n\t      E(\"td\", null), \r\n\t      E(\"td\", {className: \"pull-right\"}, \r\n\t      this.updatable(f), E(\"button\", {className: classes, \r\n\t               onClick: this.deleteFile, \"data-filename\": f.filename}, \"Delete\")\r\n\t        \r\n\t      )\r\n\t  )\r\n\t},  \r\n\tshowRemote:function(f) { \r\n\t  var classes=\"btn btn-warning\";\r\n\t  if (this.state.downloading) classes+=\" disabled\";\r\n\t  return (E(\"tr\", {\"data-id\": f.filename}, E(\"td\", null, \r\n\t      f.filename), \r\n\t      E(\"td\", null, f.desc), \r\n\t      E(\"td\", null, \r\n\t      E(\"span\", {\"data-filename\": f.filename, \"data-url\": f.url, \r\n\t            className: classes, \r\n\t            onClick: this.download}, \"Download\")\r\n\t      )\r\n\t  ));\r\n\t},\r\n\tshowFile:function(f) {\r\n\t//\treturn <span data-id={f.filename}>{f.url}</span>\r\n\t\treturn (f.ready)?this.showLocal(f):this.showRemote(f);\r\n\t},\r\n\treloadDir:function() {\r\n\t\tthis.props.action(\"reload\");\r\n\t},\r\n\tdownload:function(e) {\r\n\t\tvar url=e.target.dataset[\"url\"];\r\n\t\tvar filename=e.target.dataset[\"filename\"];\r\n\t\tthis.setState({downloading:true,progress:0,url:url});\r\n\t\tthis.userbreak=false;\r\n\t\thtml5fs.download(url,filename,function(){\r\n\t\t\tthis.reloadDir();\r\n\t\t\tthis.setState({downloading:false,progress:1});\r\n\t\t\t},function(progress,total){\r\n\t\t\t\tif (progress==0) {\r\n\t\t\t\t\tthis.setState({message:\"total \"+total})\r\n\t\t\t \t}\r\n\t\t\t \tthis.setState({progress:progress});\r\n\t\t\t \t//if user press abort return true\r\n\t\t\t \treturn this.userbreak;\r\n\t\t\t}\r\n\t\t,this);\r\n\t},\r\n\tdeleteFile:function( e) {\r\n\t\tvar filename=e.target.attributes[\"data-filename\"].value;\r\n\t\tthis.props.action(\"delete\",filename);\r\n\t},\r\n\tallFilesReady:function(e) {\r\n\t\treturn this.props.files.every(function(f){ return f.ready});\r\n\t},\r\n\tdismiss:function() {\r\n\t\t$(this.refs.dialog1.getDOMNode()).modal('hide');\r\n\t\tthis.props.action(\"dismiss\");\r\n\t},\r\n\tabortdownload:function() {\r\n\t\tthis.userbreak=true;\r\n\t},\r\n\tshowProgress:function() {\r\n\t     if (this.state.downloading) {\r\n\t      var progress=Math.round(this.state.progress*100);\r\n\t      return (\r\n\t      \tE(\"div\", null, \r\n\t      \t\"Downloading from \", this.state.url, \r\n\t      E(\"div\", {key: \"progress\", className: \"progress col-md-8\"}, \r\n\t          E(\"div\", {className: \"progress-bar\", role: \"progressbar\", \r\n\t              \"aria-valuenow\": progress, \"aria-valuemin\": \"0\", \r\n\t              \"aria-valuemax\": \"100\", style: {width: progress+\"%\"}}, \r\n\t            progress, \"%\"\r\n\t          )\r\n\t        ), \r\n\t        E(\"button\", {onClick: this.abortdownload, \r\n\t        \tclassName: \"btn btn-danger col-md-4\"}, \"Abort\")\r\n\t        )\r\n\t        );\r\n\t      } else {\r\n\t      \t\tif ( this.allFilesReady() ) {\r\n\t      \t\t\treturn E(\"button\", {onClick: this.dismiss, className: \"btn btn-success\"}, \"Ok\")\r\n\t      \t\t} else return null;\r\n\t      \t\t\r\n\t      }\r\n\t},\r\n\tshowUsage:function() {\r\n\t\tvar percent=this.props.remainPercent;\r\n           return (E(\"div\", null, E(\"span\", {className: \"pull-left\"}, \"Usage:\"), E(\"div\", {className: \"progress\"}, \r\n\t\t  E(\"div\", {className: \"progress-bar progress-bar-success progress-bar-striped\", role: \"progressbar\", style: {width: percent+\"%\"}}, \r\n\t\t    \tpercent+\"%\"\r\n\t\t  )\r\n\t\t)));\r\n\t},\r\n\trender:function() {\r\n\t  \treturn (\r\n\t\tE(\"div\", {ref: \"dialog1\", className: \"modal fade\", \"data-backdrop\": \"static\"}, \r\n\t\t    E(\"div\", {className: \"modal-dialog\"}, \r\n\t\t      E(\"div\", {className: \"modal-content\"}, \r\n\t\t        E(\"div\", {className: \"modal-header\"}, \r\n\t\t          E(\"h4\", {className: \"modal-title\"}, \"File Installer\")\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-body\"}, \r\n\t\t        \tE(\"table\", {className: \"table\"}, \r\n\t\t        \tE(\"tbody\", null, \r\n\t\t          \tthis.props.files.map(this.showFile)\r\n\t\t          \t)\r\n\t\t          )\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-footer\"}, \r\n\t\t        \tthis.showUsage(), \r\n\t\t           this.showProgress()\r\n\t\t        )\r\n\t\t      )\r\n\t\t    )\r\n\t\t  )\r\n\t\t);\r\n\t},\t\r\n\tcomponentDidMount:function() {\r\n\t\t$(this.refs.dialog1.getDOMNode()).modal('show');\r\n\t}\r\n});\r\n/*TODO kdb check version*/\r\nvar Filemanager = React.createClass({\r\n\tgetInitialState:function() {\r\n\t\tvar quota=this.getQuota();\r\n\t\treturn {browserReady:false,noupdate:true,\trequestQuota:quota,remain:0};\r\n\t},\r\n\tgetQuota:function() {\r\n\t\tvar q=this.props.quota||\"128M\";\r\n\t\tvar unit=q[q.length-1];\r\n\t\tvar times=1;\r\n\t\tif (unit==\"M\") times=1024*1024;\r\n\t\telse if (unit=\"K\") times=1024;\r\n\t\treturn parseInt(q) * times;\r\n\t},\r\n\tmissingKdb:function() {\r\n\t\tif (ksanagap.platform!=\"chrome\") return [];\r\n\t\tvar missing=this.props.needed.filter(function(kdb){\r\n\t\t\tfor (var i in html5fs.files) {\r\n\t\t\t\tif (html5fs.files[i][0]==kdb.filename) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},this);\r\n\t\treturn missing;\r\n\t},\r\n\tgetRemoteUrl:function(fn) {\r\n\t\tvar f=this.props.needed.filter(function(f){return f.filename==fn});\r\n\t\tif (f.length ) return f[0].url;\r\n\t},\r\n\tgenFileList:function(existing,missing){\r\n\t\tvar out=[];\r\n\t\tfor (var i in existing) {\r\n\t\t\tvar url=this.getRemoteUrl(existing[i][0]);\r\n\t\t\tout.push({filename:existing[i][0], url :url, ready:true });\r\n\t\t}\r\n\t\tfor (var i in missing) {\r\n\t\t\tout.push(missing[i]);\r\n\t\t}\r\n\t\treturn out;\r\n\t},\r\n\treload:function() {\r\n\t\thtml5fs.readdir(function(files){\r\n  \t\t\tthis.setState({files:this.genFileList(files,this.missingKdb())});\r\n  \t\t},this);\r\n\t },\r\n\tdeleteFile:function(fn) {\r\n\t  html5fs.rm(fn,function(){\r\n\t  \tthis.reload();\r\n\t  },this);\r\n\t},\r\n\tonQuoteOk:function(quota,usage) {\r\n\t\tif (ksanagap.platform!=\"chrome\") {\r\n\t\t\t//console.log(\"onquoteok\");\r\n\t\t\tthis.setState({noupdate:true,missing:[],files:[],autoclose:true\r\n\t\t\t\t,quota:quota,remain:quota-usage,usage:usage});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//console.log(\"quote ok\");\r\n\t\tvar files=this.genFileList(html5fs.files,this.missingKdb());\r\n\t\tvar that=this;\r\n\t\tthat.checkIfUpdate(files,function(hasupdate) {\r\n\t\t\tvar missing=this.missingKdb();\r\n\t\t\tvar autoclose=this.props.autoclose;\r\n\t\t\tif (missing.length) autoclose=false;\r\n\t\t\tthat.setState({autoclose:autoclose,\r\n\t\t\t\tquota:quota,usage:usage,files:files,\r\n\t\t\t\tmissing:missing,\r\n\t\t\t\tnoupdate:!hasupdate,\r\n\t\t\t\tremain:quota-usage});\r\n\t\t});\r\n\t},  \r\n\tonBrowserOk:function() {\r\n\t  this.totalDownloadSize();\r\n\t}, \r\n\tdismiss:function() {\r\n\t\tthis.props.onReady(this.state.usage,this.state.quota);\r\n\t\tsetTimeout(function(){\r\n\t\t\tvar modalin=$(\".modal.in\");\r\n\t\t\tif (modalin.modal) modalin.modal('hide');\r\n\t\t},500);\r\n\t}, \r\n\ttotalDownloadSize:function() {\r\n\t\tvar files=this.missingKdb();\r\n\t\tvar taskqueue=[],totalsize=0;\r\n\t\tfor (var i=0;i<files.length;i++) {\r\n\t\t\ttaskqueue.push(\r\n\t\t\t\t(function(idx){\r\n\t\t\t\t\treturn (function(data){\r\n\t\t\t\t\t\tif (!(typeof data=='object' && data.__empty)) totalsize+=data;\r\n\t\t\t\t\t\thtml5fs.getDownloadSize(files[idx].url,taskqueue.shift());\r\n\t\t\t\t\t});\r\n\t\t\t\t})(i)\r\n\t\t\t);\r\n\t\t}\r\n\t\tvar that=this;\r\n\t\ttaskqueue.push(function(data){\t\r\n\t\t\ttotalsize+=data;\r\n\t\t\tsetTimeout(function(){that.setState({requireSpace:totalsize,browserReady:true})},0);\r\n\t\t});\r\n\t\ttaskqueue.shift()({__empty:true});\r\n\t},\r\n\tcheckIfUpdate:function(files,cb) {\r\n\t\tvar taskqueue=[];\r\n\t\tfor (var i=0;i<files.length;i++) {\r\n\t\t\ttaskqueue.push(\r\n\t\t\t\t(function(idx){\r\n\t\t\t\t\treturn (function(data){\r\n\t\t\t\t\t\tif (!(typeof data=='object' && data.__empty)) files[idx-1].hasUpdate=data;\r\n\t\t\t\t\t\thtml5fs.checkUpdate(files[idx].url,files[idx].filename,taskqueue.shift());\r\n\t\t\t\t\t});\r\n\t\t\t\t})(i)\r\n\t\t\t);\r\n\t\t}\r\n\t\tvar that=this;\r\n\t\ttaskqueue.push(function(data){\t\r\n\t\t\tif (files.length) files[files.length-1].hasUpdate=data;\r\n\t\t\tvar hasupdate=files.some(function(f){return f.hasUpdate});\r\n\t\t\tif (cb) cb.apply(that,[hasupdate]);\r\n\t\t});\r\n\t\ttaskqueue.shift()({__empty:true});\r\n\t},\r\n\trender:function(){\r\n    \t\tif (!this.state.browserReady) {   \r\n      \t\t\treturn E(CheckBrowser, {feature: \"fs\", onReady: this.onBrowserOk})\r\n    \t\t} if (!this.state.quota || this.state.remain<this.state.requireSpace) {  \r\n    \t\t\tvar quota=this.state.requestQuota;\r\n    \t\t\tif (this.state.usage+this.state.requireSpace>quota) {\r\n    \t\t\t\tquota=(this.state.usage+this.state.requireSpace)*1.5;\r\n    \t\t\t}\r\n      \t\t\treturn E(HtmlFS, {quota: quota, autoclose: \"true\", onReady: this.onQuoteOk})\r\n      \t\t} else {\r\n\t\t\tif (!this.state.noupdate || this.missingKdb().length || !this.state.autoclose) {\r\n\t\t\t\tvar remain=Math.round((this.state.usage/this.state.quota)*100);\t\t\t\t\r\n\t\t\t\treturn E(FileList, {action: this.action, files: this.state.files, remainPercent: remain})\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout( this.dismiss ,0);\r\n\t\t\t\treturn E(\"span\", null, \"Success\");\r\n\t\t\t}\r\n      \t\t}\r\n\t},\r\n\taction:function() {\r\n\t  var args = Array.prototype.slice.call(arguments);\r\n\t  var type=args.shift();\r\n\t  var res=null, that=this;\r\n\t  if (type==\"delete\") {\r\n\t    this.deleteFile(args[0]);\r\n\t  }  else if (type==\"reload\") {\r\n\t  \tthis.reload();\r\n\t  } else if (type==\"dismiss\") {\r\n\t  \tthis.dismiss();\r\n\t  }\r\n\t}\r\n});\r\n\r\nmodule.exports=Filemanager;",
    "/* emulate filesystem on html5 browser */\r\nvar get_head=function(url,field,cb){\r\n\tvar xhr = new XMLHttpRequest();\r\n\txhr.open(\"HEAD\", url, true);\r\n\txhr.onreadystatechange = function() {\r\n\t\t\tif (this.readyState == this.DONE) {\r\n\t\t\t\tcb(xhr.getResponseHeader(field));\r\n\t\t\t} else {\r\n\t\t\t\tif (this.status!==200&&this.status!==206) {\r\n\t\t\t\t\tcb(\"\");\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t};\r\n\txhr.send();\t\r\n}\r\nvar get_date=function(url,cb) {\r\n\tget_head(url,\"Last-Modified\",function(value){\r\n\t\tcb(value);\r\n\t});\r\n}\r\nvar get_size=function(url, cb) {\r\n\tget_head(url,\"Content-Length\",function(value){\r\n\t\tcb(parseInt(value));\r\n\t});\r\n};\r\nvar checkUpdate=function(url,fn,cb) {\r\n\tif (!url) {\r\n\t\tcb(false);\r\n\t\treturn;\r\n\t}\r\n\tget_date(url,function(d){\r\n\t\tAPI.fs.root.getFile(fn, {create: false, exclusive: false}, function(fileEntry) {\r\n\t\t\tfileEntry.getMetadata(function(metadata){\r\n\t\t\t\tvar localDate=Date.parse(metadata.modificationTime);\r\n\t\t\t\tvar urlDate=Date.parse(d);\r\n\t\t\t\tcb(urlDate>localDate);\r\n\t\t\t});\r\n\t\t},function(){\r\n\t\t\tcb(false);\r\n\t\t});\r\n\t});\r\n}\r\nvar download=function(url,fn,cb,statuscb,context) {\r\n\t var totalsize=0,batches=null,written=0;\r\n\t var fileEntry=0, fileWriter=0;\r\n\t var createBatches=function(size) {\r\n\t\tvar bytes=1024*1024, out=[];\r\n\t\tvar b=Math.floor(size / bytes);\r\n\t\tvar last=size %bytes;\r\n\t\tfor (var i=0;i<=b;i++) {\r\n\t\t\tout.push(i*bytes);\r\n\t\t}\r\n\t\tout.push(b*bytes+last);\r\n\t\treturn out;\r\n\t }\r\n\t var finish=function() {\r\n\t\t rm(fn,function(){\r\n\t\t\t\tfileEntry.moveTo(fileEntry.filesystem.root, fn,function(){\r\n\t\t\t\t\tsetTimeout( cb.bind(context,false) , 0) ; \r\n\t\t\t\t},function(e){\r\n\t\t\t\t\tconsole.log(\"failed\",e)\r\n\t\t\t\t});\r\n\t\t },this); \r\n\t };\r\n\t\tvar tempfn=\"temp.kdb\";\r\n\t\tvar batch=function(b) {\r\n\t\tvar abort=false;\r\n\t\tvar xhr = new XMLHttpRequest();\r\n\t\tvar requesturl=url+\"?\"+Math.random();\r\n\t\txhr.open('get', requesturl, true);\r\n\t\txhr.setRequestHeader('Range', 'bytes='+batches[b]+'-'+(batches[b+1]-1));\r\n\t\txhr.responseType = 'blob';    \r\n\t\txhr.addEventListener('load', function() {\r\n\t\t\tvar blob=this.response;\r\n\t\t\tfileEntry.createWriter(function(fileWriter) {\r\n\t\t\t\tfileWriter.seek(fileWriter.length);\r\n\t\t\t\tfileWriter.write(blob);\r\n\t\t\t\twritten+=blob.size;\r\n\t\t\t\tfileWriter.onwriteend = function(e) {\r\n\t\t\t\t\tif (statuscb) {\r\n\t\t\t\t\t\tabort=statuscb.apply(context,[ fileWriter.length / totalsize,totalsize ]);\r\n\t\t\t\t\t\tif (abort) setTimeout( cb.bind(context,false) , 0) ;\r\n\t\t\t\t \t}\r\n\t\t\t\t\tb++;\r\n\t\t\t\t\tif (!abort) {\r\n\t\t\t\t\t\tif (b<batches.length-1) setTimeout(batch.bind(context,b),0);\r\n\t\t\t\t\t\telse                    finish();\r\n\t\t\t\t \t}\r\n\t\t\t \t};\r\n\t\t\t}, console.error);\r\n\t\t},false);\r\n\t\txhr.send();\r\n\t}\r\n\r\n\tget_size(url,function(size){\r\n\t\ttotalsize=size;\r\n\t\tif (!size) {\r\n\t\t\tif (cb) cb.apply(context,[false]);\r\n\t\t} else {//ready to download\r\n\t\t\trm(tempfn,function(){\r\n\t\t\t\t batches=createBatches(size);\r\n\t\t\t\t if (statuscb) statuscb.apply(context,[ 0, totalsize ]);\r\n\t\t\t\t API.fs.root.getFile(tempfn, {create: 1, exclusive: false}, function(_fileEntry) {\r\n\t\t\t\t\t\t\tfileEntry=_fileEntry;\r\n\t\t\t\t\t\tbatch(0);\r\n\t\t\t\t });\r\n\t\t\t},this);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nvar readFile=function(filename,cb,context) {\r\n\tAPI.fs.root.getFile(filename, function(fileEntry) {\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\treader.onloadend = function(e) {\r\n\t\t\t\t\tif (cb) cb.apply(cb,[this.result]);\r\n\t\t\t\t};            \r\n\t}, console.error);\r\n}\r\nvar writeFile=function(filename,buf,cb,context){\r\n\tAPI.fs.root.getFile(filename, {create: true, exclusive: true}, function(fileEntry) {\r\n\t\t\tfileEntry.createWriter(function(fileWriter) {\r\n\t\t\t\tfileWriter.write(buf);\r\n\t\t\t\tfileWriter.onwriteend = function(e) {\r\n\t\t\t\t\tif (cb) cb.apply(cb,[buf.byteLength]);\r\n\t\t\t\t};            \r\n\t\t\t}, console.error);\r\n\t}, console.error);\r\n}\r\n\r\nvar readdir=function(cb,context) {\r\n\tvar dirReader = API.fs.root.createReader();\r\n\tvar out=[],that=this;\r\n\tdirReader.readEntries(function(entries) {\r\n\t\tif (entries.length) {\r\n\t\t\tfor (var i = 0, entry; entry = entries[i]; ++i) {\r\n\t\t\t\tif (entry.isFile) {\r\n\t\t\t\t\tout.push([entry.name,entry.toURL ? entry.toURL() : entry.toURI()]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tAPI.files=out;\r\n\t\tif (cb) cb.apply(context,[out]);\r\n\t}, function(){\r\n\t\tif (cb) cb.apply(context,[null]);\r\n\t});\r\n}\r\nvar getFileURL=function(filename) {\r\n\tif (!API.files ) return null;\r\n\tvar file= API.files.filter(function(f){return f[0]==filename});\r\n\tif (file.length) return file[0][1];\r\n}\r\nvar rm=function(filename,cb,context) {\r\n\tvar url=getFileURL(filename);\r\n\tif (url) rmURL(url,cb,context);\r\n\telse if (cb) cb.apply(context,[false]);\r\n}\r\n\r\nvar rmURL=function(filename,cb,context) {\r\n\twebkitResolveLocalFileSystemURL(filename, function(fileEntry) {\r\n\t\tfileEntry.remove(function() {\r\n\t\t\tif (cb) cb.apply(context,[true]);\r\n\t\t}, console.error);\r\n\t},  function(e){\r\n\t\tif (cb) cb.apply(context,[false]);//no such file\r\n\t});\r\n}\r\nfunction errorHandler(e) {\r\n\tconsole.error('Error: ' +e.name+ \" \"+e.message);\r\n}\r\nvar initfs=function(grantedBytes,cb,context) {\r\n\twebkitRequestFileSystem(PERSISTENT, grantedBytes,  function(fs) {\r\n\t\tAPI.fs=fs;\r\n\t\tAPI.quota=grantedBytes;\r\n\t\treaddir(function(){\r\n\t\t\tAPI.initialized=true;\r\n\t\t\tcb.apply(context,[grantedBytes,fs]);\r\n\t\t},context);\r\n\t}, errorHandler);\r\n}\r\nvar init=function(quota,cb,context) {\r\n\tnavigator.webkitPersistentStorage.requestQuota(quota, \r\n\t\t\tfunction(grantedBytes) {\r\n\t\t\t\tinitfs(grantedBytes,cb,context);\r\n\t\t}, errorHandler\r\n\t);\r\n}\r\nvar queryQuota=function(cb,context) {\r\n\tvar that=this;\r\n\tnavigator.webkitPersistentStorage.queryUsageAndQuota( \r\n\t function(usage,quota){\r\n\t\t\tinitfs(quota,function(){\r\n\t\t\t\tcb.apply(context,[usage,quota]);\r\n\t\t\t},context);\r\n\t});\r\n}\r\nvar API={\r\n\tinit:init\r\n\t,readdir:readdir\r\n\t,checkUpdate:checkUpdate\r\n\t,rm:rm\r\n\t,rmURL:rmURL\r\n\t,getFileURL:getFileURL\r\n\t,writeFile:writeFile\r\n\t,readFile:readFile\r\n\t,download:download\r\n\t,get_head:get_head\r\n\t,get_date:get_date\r\n\t,get_size:get_size\r\n\t,getDownloadSize:get_size\r\n\t,queryQuota:queryQuota\r\n}\r\nmodule.exports=API;",
    "var html5fs=require(\"./html5fs\");\r\nvar React=(window&&window.React)||require(\"react\");\r\nvar E=React.createElement;\r\n\r\nvar htmlfs = React.createClass({\r\n\tgetInitialState:function() { \r\n\t\treturn {ready:false, quota:0,usage:0,Initialized:false,autoclose:this.props.autoclose};\r\n\t},\r\n\tinitFilesystem:function() {\r\n\t\tvar quota=this.props.quota||1024*1024*128; // default 128MB\r\n\t\tquota=parseInt(quota);\r\n\t\thtml5fs.init(quota,function(q){\r\n\t\t\tthis.dialog=false;\r\n\t\t\t$(this.refs.dialog1.getDOMNode()).modal('hide');\r\n\t\t\tthis.setState({quota:q,autoclose:true});\r\n\t\t},this);\r\n\t},\r\n\twelcome:function() {\r\n\t\treturn (\r\n\t\tE(\"div\", {ref: \"dialog1\", className: \"modal fade\", id: \"myModal\", \"data-backdrop\": \"static\"}, \r\n\t\t    E(\"div\", {className: \"modal-dialog\"}, \r\n\t\t      E(\"div\", {className: \"modal-content\"}, \r\n\t\t        E(\"div\", {className: \"modal-header\"}, \r\n\t\t          E(\"h4\", {className: \"modal-title\"}, \"Welcome\")\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-body\"}, \r\n\t\t          \"Browser will ask for your confirmation.\"\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-footer\"}, \r\n\t\t          E(\"button\", {onClick: this.initFilesystem, type: \"button\", \r\n\t\t            className: \"btn btn-primary\"}, \"Initialize File System\")\r\n\t\t        )\r\n\t\t      )\r\n\t\t    )\r\n\t\t  )\r\n\t\t );\r\n\t},\r\n\trenderDefault:function(){\r\n\t\tvar used=Math.floor(this.state.usage/this.state.quota *100);\r\n\t\tvar more=function() {\r\n\t\t\tif (used>50) return E(\"button\", {type: \"button\", className: \"btn btn-primary\"}, \"Allocate More\");\r\n\t\t\telse null;\r\n\t\t}\r\n\t\treturn (\r\n\t\tE(\"div\", {ref: \"dialog1\", className: \"modal fade\", id: \"myModal\", \"data-backdrop\": \"static\"}, \r\n\t\t    E(\"div\", {className: \"modal-dialog\"}, \r\n\t\t      E(\"div\", {className: \"modal-content\"}, \r\n\t\t        E(\"div\", {className: \"modal-header\"}, \r\n\t\t          E(\"h4\", {className: \"modal-title\"}, \"Sandbox File System\")\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-body\"}, \r\n\t\t          E(\"div\", {className: \"progress\"}, \r\n\t\t            E(\"div\", {className: \"progress-bar\", role: \"progressbar\", style: {width: used+\"%\"}}, \r\n\t\t               used, \"%\"\r\n\t\t            )\r\n\t\t          ), \r\n\t\t          E(\"span\", null, this.state.quota, \" total , \", this.state.usage, \" in used\")\r\n\t\t        ), \r\n\t\t        E(\"div\", {className: \"modal-footer\"}, \r\n\t\t          E(\"button\", {onClick: this.dismiss, type: \"button\", className: \"btn btn-default\", \"data-dismiss\": \"modal\"}, \"Close\"), \r\n\t\t          more()\r\n\t\t        )\r\n\t\t      )\r\n\t\t    )\r\n\t\t  )\r\n\t\t  );\r\n\t},\r\n\tdismiss:function() {\r\n\t\tvar that=this;\r\n\t\tsetTimeout(function(){\r\n\t\t\tthat.props.onReady(that.state.quota,that.state.usage);\t\r\n\t\t},0);\r\n\t},\r\n\tqueryQuota:function() {\r\n\t\tif (ksanagap.platform==\"chrome\") {\r\n\t\t\thtml5fs.queryQuota(function(usage,quota){\r\n\t\t\t\tthis.setState({usage:usage,quota:quota,initialized:true});\r\n\t\t\t},this);\t\t\t\r\n\t\t} else {\r\n\t\t\tthis.setState({usage:333,quota:1000*1000*1024,initialized:true,autoclose:true});\r\n\t\t}\r\n\t},\r\n\trender:function() {\r\n\t\tvar that=this;\r\n\t\tif (!this.state.quota || this.state.quota<this.props.quota) {\r\n\t\t\tif (this.state.initialized) {\r\n\t\t\t\tthis.dialog=true;\r\n\t\t\t\treturn this.welcome();\t\r\n\t\t\t} else {\r\n\t\t\t\treturn E(\"span\", null, \"checking quota\");\r\n\t\t\t}\t\t\t\r\n\t\t} else {\r\n\t\t\tif (!this.state.autoclose) {\r\n\t\t\t\tthis.dialog=true;\r\n\t\t\t\treturn this.renderDefault(); \r\n\t\t\t}\r\n\t\t\tthis.dismiss();\r\n\t\t\tthis.dialog=false;\r\n\t\t\treturn null;\r\n\t\t}\r\n\t},\r\n\tcomponentDidMount:function() {\r\n\t\tif (!this.state.quota) {\r\n\t\t\tthis.queryQuota();\r\n\r\n\t\t};\r\n\t},\r\n\tcomponentDidUpdate:function() {\r\n\t\tif (this.dialog) $(this.refs.dialog1.getDOMNode()).modal('show');\r\n\t}\r\n});\r\n\r\nmodule.exports=htmlfs;",
    "var ksana={\"platform\":\"remote\"};\r\nif (typeof window!=\"undefined\") {\r\n\twindow.ksana=ksana;\r\n\tif (typeof ksanagap==\"undefined\") {\r\n\t\twindow.ksanagap=require(\"./ksanagap\"); //compatible layer with mobile\r\n\t}\r\n}\r\nif (typeof process !=\"undefined\") {\r\n\tif (process.versions && process.versions[\"node-webkit\"]) {\r\n  \t\tif (typeof nodeRequire!=\"undefined\") ksana.require=nodeRequire;\r\n  \t\tksana.platform=\"node-webkit\";\r\n  \t\twindow.ksanagap.platform=\"node-webkit\";\r\n\t\tvar ksanajs=require(\"fs\").readFileSync(\"ksana.js\",\"utf8\").trim();\r\n\t\tksana.js=JSON.parse(ksanajs.substring(14,ksanajs.length-1));\r\n\t\twindow.kfs=require(\"./kfs\");\r\n  \t}\r\n} else if (typeof chrome!=\"undefined\"){//} && chrome.fileSystem){\r\n//\twindow.ksanagap=require(\"./ksanagap\"); //compatible layer with mobile\r\n\twindow.ksanagap.platform=\"chrome\";\r\n\twindow.kfs=require(\"./kfs_html5\");\r\n\tif(window.location.origin.indexOf(\"//127.0.0.1\")>-1) {\r\n\t\trequire(\"./livereload\")();\r\n\t}\r\n\tksana.platform=\"chrome\";\r\n} else {\r\n\tif (typeof ksanagap!=\"undefined\" && typeof fs!=\"undefined\") {//mobile\r\n\t\tvar ksanajs=fs.readFileSync(\"ksana.js\",\"utf8\").trim(); //android extra \\n at the end\r\n\t\tksana.js=JSON.parse(ksanajs.substring(14,ksanajs.length-1));\r\n\t\tksana.platform=ksanagap.platform;\r\n\t\tif (typeof ksanagap.android !=\"undefined\") {\r\n\t\t\tksana.platform=\"android\";\r\n\t\t}\r\n\t}\r\n}\r\nvar timer=null;\r\nvar React=window.React||require(\"react\");\r\nvar boot=function(appId,cb) {\r\n\tif (typeof React!=\"undefined\") {\r\n\t\tReact.initializeTouchEvents(true);\r\n\t}\r\n\tksana.appId=appId;\r\n\tif (ksanagap.platform==\"chrome\") { //need to wait for jsonp ksana.js\r\n\t\ttimer=setInterval(function(){\r\n\t\t\tif (ksana.ready){\r\n\t\t\t\tclearInterval(timer);\r\n\t\t\t\tif (ksana.js && ksana.js.files && ksana.js.files.length) {\r\n\t\t\t\t\trequire(\"./installkdb\")(ksana.js,cb);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcb();\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},300);\r\n\t} else {\r\n\t\tcb();\r\n\t}\r\n}\r\n\r\nmodule.exports={boot:boot\r\n\t,htmlfs:require(\"./htmlfs\")\r\n\t,html5fs:require(\"./html5fs\")\r\n\t,liveupdate:require(\"./liveupdate\")\r\n\t,fileinstaller:require(\"./fileinstaller\")\r\n\t,downloader:require(\"./downloader\")\r\n\t,installkdb:require(\"./installkdb\")\r\n};",
    "var React=(window&&window.React)||require(\"react\");\r\nvar Fileinstaller=require(\"./fileinstaller\");\r\n\r\nvar getRequire_kdb=function() {\r\n    var required=[];\r\n    ksana.js.files.map(function(f){\r\n      if (f.indexOf(\".kdb\")==f.length-4) {\r\n        var slash=f.lastIndexOf(\"/\");\r\n        if (slash>-1) {\r\n          var dbid=f.substring(slash+1,f.length-4);\r\n          required.push({url:f,dbid:dbid,filename:dbid+\".kdb\"});\r\n        } else {\r\n          var dbid=f.substring(0,f.length-4);\r\n          required.push({url:ksana.js.baseurl+f,dbid:dbid,filename:f});\r\n        }        \r\n      }\r\n    });\r\n    return required;\r\n}\r\nvar callback=null;\r\nvar onReady=function() {\r\n\tcallback();\r\n}\r\nvar openFileinstaller=function(keep) {\r\n\tvar require_kdb=getRequire_kdb().map(function(db){\r\n\t  return {\r\n\t    url:window.location.origin+window.location.pathname+db.dbid+\".kdb\",\r\n\t    dbdb:db.dbid,\r\n\t    filename:db.filename\r\n\t  }\r\n\t})\r\n\treturn React.createElement(Fileinstaller, {quota: \"512M\", autoclose: !keep, needed: require_kdb, \r\n\t                 onReady: onReady});\r\n}\r\nvar installkdb=function(ksanajs,cb,context) {\r\n\tReact.render(openFileinstaller(),document.getElementById(\"main\"));\r\n\tcallback=cb;\r\n}\r\nmodule.exports=installkdb;",
    "//Simulate feature in ksanagap\r\n/* \r\n  runs on node-webkit only\r\n*/\r\n\r\nvar readDir=function(path) { //simulate Ksanagap function\r\n\tvar fs=nodeRequire(\"fs\");\r\n\tpath=path||\"..\";\r\n\tvar dirs=[];\r\n\tif (path[0]==\".\") {\r\n\t\tif (path==\".\") dirs=fs.readdirSync(\".\");\r\n\t\telse {\r\n\t\t\tdirs=fs.readdirSync(\"..\");\r\n\t\t}\r\n\t} else {\r\n\t\tdirs=fs.readdirSync(path);\r\n\t}\r\n\r\n\treturn dirs.join(\"\\uffff\");\r\n}\r\nvar listApps=function() {\r\n\r\n\tvar fs=nodeRequire(\"fs\");\r\n\tvar ksanajsfile=function(d) {return \"../\"+d+\"/ksana.js\"};\r\n\tvar dirs=fs.readdirSync(\"..\").filter(function(d){\r\n\t\t\t\treturn fs.statSync(\"../\"+d).isDirectory() && d[0]!=\".\"\r\n\t\t\t\t   && fs.existsSync(ksanajsfile(d));\r\n\t});\r\n\t\r\n\tvar out=dirs.map(function(d){\r\n\r\n\t\tvar fn=ksanajsfile(d);\r\n\t\tif (!fs.existsSync(fn)) return;\r\n\t\tvar content=fs.readFileSync(fn,\"utf8\");\r\n  \t\tcontent=content.replace(\"})\",\"}\");\r\n  \t\tcontent=content.replace(\"jsonp_handler(\",\"\");\r\n  \t\ttry{\r\n  \t\t\tvar obj= JSON.parse(content);\r\n\t\t\tobj.dbid=d;\r\n\t\t\tobj.path=d;\r\n\t\t\treturn obj;\r\n  \t\t} catch(e) {\r\n  \t\t\tconsole.log(e);\r\n  \t\t\treturn null;\r\n  \t\t}\r\n\t});\r\n\r\n\tout=out.filter(function(o){return !!o});\r\n\treturn JSON.stringify(out);\r\n}\r\n\r\n\r\n\r\nvar kfs={readDir:readDir,listApps:listApps};\r\n\r\nmodule.exports=kfs;",
    "var readDir=function(){\r\n\treturn \"[]\";\r\n}\r\nvar listApps=function(){\r\n\treturn \"[]\";\r\n}\r\nmodule.exports={readDir:readDir,listApps:listApps};",
    "var appname=\"installer\";\r\nvar switchApp=function(path) {\r\n\tvar fs=require(\"fs\");\r\n\tpath=\"../\"+path;\r\n\tappname=path;\r\n\tdocument.location.href= path+\"/index.html\"; \r\n\tprocess.chdir(path);\r\n}\r\nvar downloader={};\r\nvar rootPath=\"\";\r\n\r\nvar deleteApp=function(app) {\r\n\tconsole.error(\"not allow on PC, do it in File Explorer/ Finder\");\r\n}\r\nvar username=function() {\r\n\treturn \"\";\r\n}\r\nvar useremail=function() {\r\n\treturn \"\"\r\n}\r\nvar runtime_version=function() {\r\n\treturn \"1.4\";\r\n}\r\n\r\n//copy from liveupdate\r\nvar jsonp=function(url,dbid,callback,context) {\r\n  var script=document.getElementById(\"jsonp2\");\r\n  if (script) {\r\n    script.parentNode.removeChild(script);\r\n  }\r\n  window.jsonp_handler=function(data) {\r\n    if (typeof data==\"object\") {\r\n      data.dbid=dbid;\r\n      callback.apply(context,[data]);    \r\n    }  \r\n  }\r\n  window.jsonp_error_handler=function() {\r\n    console.error(\"url unreachable\",url);\r\n    callback.apply(context,[null]);\r\n  }\r\n  script=document.createElement('script');\r\n  script.setAttribute('id', \"jsonp2\");\r\n  script.setAttribute('onerror', \"jsonp_error_handler()\");\r\n  url=url+'?'+(new Date().getTime());\r\n  script.setAttribute('src', url);\r\n  document.getElementsByTagName('head')[0].appendChild(script); \r\n}\r\n\r\nvar ksanagap={\r\n\tplatform:\"node-webkit\",\r\n\tstartDownload:downloader.startDownload,\r\n\tdownloadedByte:downloader.downloadedByte,\r\n\tdownloadingFile:downloader.downloadingFile,\r\n\tcancelDownload:downloader.cancelDownload,\r\n\tdoneDownload:downloader.doneDownload,\r\n\tswitchApp:switchApp,\r\n\trootPath:rootPath,\r\n\tdeleteApp: deleteApp,\r\n\tusername:username, //not support on PC\r\n\tuseremail:username,\r\n\truntime_version:runtime_version,\r\n\t\r\n}\r\n\r\nif (typeof process!=\"undefined\" && !process.browser) {\r\n\tvar ksanajs=require(\"fs\").readFileSync(\"./ksana.js\",\"utf8\").trim();\r\n\tdownloader=require(\"./downloader\");\r\n\t//ksana.js=JSON.parse(ksanajs.substring(14,ksanajs.length-1));\r\n\trootPath=process.cwd();\r\n\trootPath=require(\"path\").resolve(rootPath,\"..\").replace(/\\\\/g,\"/\")+'/';\r\n\tksana.ready=true;\r\n} else{\r\n\tvar url=window.location.origin+window.location.pathname.replace(\"index.html\",\"\")+\"ksana.js\";\r\n\tjsonp(url,appname,function(data){\r\n\t\tksana.js=data;\r\n\t\tksana.ready=true;\r\n\t});\r\n}\r\nmodule.exports=ksanagap;",
    "var started=false;\r\nvar timer=null;\r\nvar bundledate=null;\r\nvar get_date=require(\"./html5fs\").get_date;\r\nvar checkIfBundleUpdated=function() {\r\n\tget_date(\"bundle.js\",function(date){\r\n\t\tif (bundledate &&bundledate!=date){\r\n\t\t\tlocation.reload();\r\n\t\t}\r\n\t\tbundledate=date;\r\n\t});\r\n}\r\nvar livereload=function() {\r\n\tif (started) return;\r\n\r\n\ttimer1=setInterval(function(){\r\n\t\tcheckIfBundleUpdated();\r\n\t},2000);\r\n\tstarted=true;\r\n}\r\n\r\nmodule.exports=livereload;",
    "\r\nvar jsonp=function(url,dbid,callback,context) {\r\n  var script=document.getElementById(\"jsonp\");\r\n  if (script) {\r\n    script.parentNode.removeChild(script);\r\n  }\r\n  if (typeof dbid==\"function\") {\r\n    context=callback;\r\n    callback=dbid;\r\n    dbid=\"\";\r\n  }\r\n  window.jsonp_handler=function(data) {\r\n    //console.log(\"receive from ksana.js\",data);\r\n    if (typeof data==\"object\" && dbid) {\r\n      if (typeof data.dbid==\"undefined\") {\r\n        data.dbid=dbid;\r\n      }\r\n    }\r\n    callback.apply(context,[data]);\r\n  }\r\n\r\n  window.jsonp_error_handler=function() {\r\n    console.error(\"url unreachable\",url);\r\n    callback.apply(context,[null]);\r\n  }\r\n\r\n  script=document.createElement('script');\r\n  script.setAttribute('id', \"jsonp\");\r\n  script.setAttribute('onerror', \"jsonp_error_handler()\");\r\n  url=url+'?'+(new Date().getTime());\r\n  script.setAttribute('src', url);\r\n  document.getElementsByTagName('head')[0].appendChild(script); \r\n}\r\nvar runtime_version_ok=function(minruntime) {\r\n  if (!minruntime) return true;//not mentioned.\r\n  var min=parseFloat(minruntime);\r\n  var runtime=parseFloat( ksanagap.runtime_version()||\"1.0\");\r\n  if (min>runtime) return false;\r\n  return true;\r\n}\r\n\r\nvar needToUpdate=function(fromjson,tojson) {\r\n  var needUpdates=[];\r\n  for (var i=0;i<fromjson.length;i++) { \r\n    var to=tojson[i];\r\n    var from=fromjson[i];\r\n    var newfiles=[],newfilesizes=[],removed=[];\r\n    \r\n    if (!to || !to.files) continue; //cannot reach host\r\n    if (!runtime_version_ok(to.minruntime)) {\r\n      console.warn(\"runtime too old, need \"+to.minruntime);\r\n      continue; \r\n    }\r\n    if (!from.filedates) {\r\n      console.warn(\"missing filedates in ksana.js of \"+from.dbid);\r\n      continue;\r\n    }\r\n    from.filedates.map(function(f,idx){\r\n      var newidx=to.files.indexOf( from.files[idx]);\r\n      if (newidx==-1) {\r\n        //file removed in new version\r\n        removed.push(from.files[idx]);\r\n      } else {\r\n        var fromdate=Date.parse(f);\r\n        var todate=Date.parse(to.filedates[newidx]);\r\n        if (fromdate<todate) {\r\n          newfiles.push( to.files[newidx] );\r\n          newfilesizes.push(to.filesizes[newidx]);\r\n        }        \r\n      }\r\n    });\r\n    if (newfiles.length) {\r\n      from.newfiles=newfiles;\r\n      from.newfilesizes=newfilesizes;\r\n      from.removed=removed;\r\n      needUpdates.push(from);\r\n    }\r\n  }\r\n  return needUpdates;\r\n}\r\nvar getUpdatables=function(apps,cb,context) {\r\n  getRemoteJson(apps,function(jsons){\r\n    var hasUpdates=needToUpdate(apps,jsons);\r\n    cb.apply(context,[hasUpdates]);\r\n  },context);\r\n}\r\nvar getRemoteJson=function(apps,cb,context) {\r\n  var taskqueue=[],output=[];\r\n  var makecb=function(app){\r\n    return function(data){\r\n        if (!(data && typeof data =='object' && data.__empty)) output.push(data);\r\n        if (!app.baseurl) {\r\n          taskqueue.shift({__empty:true});\r\n        } else {\r\n          var url=app.baseurl+\"/ksana.js\";\r\n          try {\r\n            jsonp( url ,app.dbid,taskqueue.shift(), context);             \r\n          } catch(e) {\r\n            console.log(e);\r\n            taskqueue.shift({__empty:true});\r\n          }\r\n        }\r\n    };\r\n  };\r\n  apps.forEach(function(app){taskqueue.push(makecb(app))});\r\n\r\n  taskqueue.push(function(data){\r\n    output.push(data);\r\n    cb.apply(context,[output]);\r\n  });\r\n\r\n  taskqueue.shift()({__empty:true}); //run the task\r\n}\r\nvar humanFileSize=function(bytes, si) {\r\n    var thresh = si ? 1000 : 1024;\r\n    if(bytes < thresh) return bytes + ' B';\r\n    var units = si ? ['kB','MB','GB','TB','PB','EB','ZB','YB'] : ['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];\r\n    var u = -1;\r\n    do {\r\n        bytes /= thresh;\r\n        ++u;\r\n    } while(bytes >= thresh);\r\n    return bytes.toFixed(1)+' '+units[u];\r\n};\r\nvar humanDate=function(datestring) {\r\n    var d=Date.parse(datestring);\r\n    if (isNaN(d)) {\r\n      return \"invalid date\";\r\n    } else {\r\n      return new Date(d).toLocaleString();\r\n    }\r\n}\r\nvar start=function(ksanajs,cb,context){\r\n  var files=ksanajs.newfiles||ksanajs.files;\r\n  var baseurl=ksanajs.baseurl|| \"http://127.0.0.1:8080/\"+ksanajs.dbid+\"/\";\r\n  var started=ksanagap.startDownload(ksanajs.dbid,baseurl,files.join(\"\\uffff\"));\r\n  cb.apply(context,[started]);\r\n}\r\nvar status=function(){\r\n  var nfile=ksanagap.downloadingFile();\r\n  var downloadedByte=ksanagap.downloadedByte();\r\n  var done=ksanagap.doneDownload();\r\n  return {nfile:nfile,downloadedByte:downloadedByte, done:done};\r\n}\r\n\r\nvar cancel=function(){\r\n  return ksanagap.cancelDownload();\r\n}\r\n\r\nvar liveupdate={ humanFileSize: humanFileSize, humanDate:humanDate,\r\n  needToUpdate: needToUpdate , jsonp:jsonp, \r\n  getUpdatables:getUpdatables,\r\n  start:start,\r\n  cancel:cancel,\r\n  status:status\r\n  };\r\nmodule.exports=liveupdate;",
    "function mkdirP (p, mode, f, made) {\r\n     var path = nodeRequire('path');\r\n     var fs = nodeRequire('fs');\r\n\t\r\n    if (typeof mode === 'function' || mode === undefined) {\r\n        f = mode;\r\n        mode = 0x1FF & (~process.umask());\r\n    }\r\n    if (!made) made = null;\r\n\r\n    var cb = f || function () {};\r\n    if (typeof mode === 'string') mode = parseInt(mode, 8);\r\n    p = path.resolve(p);\r\n\r\n    fs.mkdir(p, mode, function (er) {\r\n        if (!er) {\r\n            made = made || p;\r\n            return cb(null, made);\r\n        }\r\n        switch (er.code) {\r\n            case 'ENOENT':\r\n                mkdirP(path.dirname(p), mode, function (er, made) {\r\n                    if (er) cb(er, made);\r\n                    else mkdirP(p, mode, cb, made);\r\n                });\r\n                break;\r\n\r\n            // In the case of any other error, just see if there's a dir\r\n            // there already.  If so, then hooray!  If not, then something\r\n            // is borked.\r\n            default:\r\n                fs.stat(p, function (er2, stat) {\r\n                    // if the stat fails, then that's super weird.\r\n                    // let the original error be the failure reason.\r\n                    if (er2 || !stat.isDirectory()) cb(er, made)\r\n                    else cb(null, made);\r\n                });\r\n                break;\r\n        }\r\n    });\r\n}\r\n\r\nmkdirP.sync = function sync (p, mode, made) {\r\n    var path = nodeRequire('path');\r\n    var fs = nodeRequire('fs');\r\n    if (mode === undefined) {\r\n        mode = 0x1FF & (~process.umask());\r\n    }\r\n    if (!made) made = null;\r\n\r\n    if (typeof mode === 'string') mode = parseInt(mode, 8);\r\n    p = path.resolve(p);\r\n\r\n    try {\r\n        fs.mkdirSync(p, mode);\r\n        made = made || p;\r\n    }\r\n    catch (err0) {\r\n        switch (err0.code) {\r\n            case 'ENOENT' :\r\n                made = sync(path.dirname(p), mode, made);\r\n                sync(p, mode, made);\r\n                break;\r\n\r\n            // In the case of any other error, just see if there's a dir\r\n            // there already.  If so, then hooray!  If not, then something\r\n            // is borked.\r\n            default:\r\n                var stat;\r\n                try {\r\n                    stat = fs.statSync(p);\r\n                }\r\n                catch (err1) {\r\n                    throw err0;\r\n                }\r\n                if (!stat.isDirectory()) throw err0;\r\n                break;\r\n        }\r\n    }\r\n\r\n    return made;\r\n};\r\n\r\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\r\n",
    "var React=require(\"react\");\r\nvar runtime=require(\"ksana2015-webruntime\");\r\nruntime.boot(\"treetoc-sample\",function(){\r\n\tvar Main=React.createElement(require(\"./src/main.jsx\"));\r\n\tksana.mainComponent=React.render(Main,document.getElementById(\"main\"));\r\n});",
    "module.exports=[{\"d\":0,\"t\":\"江味農金剛經講義\"},{\"d\":1,\"t\":\"總釋名題\"},{\"d\":2,\"t\":\"釋經題\"},{\"d\":3,\"t\":\"說般若網要\"},{\"d\":3,\"t\":\"明融會各家\"},{\"d\":3,\"t\":\"依五重譯題\"},{\"d\":4,\"t\":\"總解科意\"},{\"d\":4,\"t\":\"依次開釋\"},{\"d\":5,\"t\":\"釋名\"},{\"d\":6,\"t\":\"通名\"},{\"d\":6,\"t\":\"別名\"},{\"d\":5,\"t\":\"顯體\"},{\"d\":6,\"t\":\"明體義\"},{\"d\":6,\"t\":\"辨異同\"},{\"d\":6,\"t\":\"正顯體\"},{\"d\":5,\"t\":\"明宗\"},{\"d\":6,\"t\":\"明宗義\"},{\"d\":6,\"t\":\"辨異同\"},{\"d\":6,\"t\":\"正明宗\"},{\"d\":5,\"t\":\"辨用\"},{\"d\":5,\"t\":\"判教相\"},{\"d\":6,\"t\":\"總論\"},{\"d\":7,\"t\":\"解釋名義\"},{\"d\":7,\"t\":\"泛論教相\"},{\"d\":6,\"t\":\"正判\"},{\"d\":2,\"t\":\"釋人題\"},{\"d\":1,\"t\":\"別解文義\"},{\"d\":2,\"t\":\"序分\"},{\"d\":3,\"t\":\"證信序\"},{\"d\":3,\"t\":\"發起序\"},{\"d\":2,\"t\":\"正宗分\"},{\"d\":3,\"t\":\"當機讚請\"},{\"d\":4,\"t\":\"禮讚\"},{\"d\":5,\"t\":\"具儀\"},{\"d\":5,\"t\":\"稱讚\"},{\"d\":4,\"t\":\"請法\"},{\"d\":3,\"t\":\"如來讚許\"},{\"d\":4,\"t\":\"讚印\"},{\"d\":4,\"t\":\"許說\"},{\"d\":5,\"t\":\"總示\"},{\"d\":6,\"t\":\"誡聽標宗\"},{\"d\":6,\"t\":\"契旨請詳\"},{\"d\":5,\"t\":\"詳談\"},{\"d\":6,\"t\":\"約境明無住以彰般若正智\"},{\"d\":7,\"t\":\"的示無住以生信\"},{\"d\":8,\"t\":\"明示\"},{\"d\":9,\"t\":\"明發離相心即是降伏\"},{\"d\":10,\"t\":\"標示\"},{\"d\":10,\"t\":\"正明\"},{\"d\":10,\"t\":\"徵釋\"},{\"d\":9,\"t\":\"不住於相即是正住\"},{\"d\":10,\"t\":\"正明無住\"},{\"d\":11,\"t\":\"標示\"},{\"d\":11,\"t\":\"指釋\"},{\"d\":11,\"t\":\"結成\"},{\"d\":10,\"t\":\"釋顯其故\"},{\"d\":11,\"t\":\"徵釋\"},{\"d\":11,\"t\":\"喻明\"},{\"d\":11,\"t\":\"法合\"},{\"d\":10,\"t\":\"結示正住\"},{\"d\":10,\"t\":\"更明所以\"},{\"d\":11,\"t\":\"問答釋明\"},{\"d\":12,\"t\":\"問\"},{\"d\":12,\"t\":\"答\"},{\"d\":13,\"t\":\"雙明\"},{\"d\":13,\"t\":\"釋成\"},{\"d\":11,\"t\":\"闡義印許\"},{\"d\":12,\"t\":\"明性本非相\"},{\"d\":12,\"t\":\"明即相見性\"},{\"d\":8,\"t\":\"生信\"},{\"d\":9,\"t\":\"揀示根機\"},{\"d\":10,\"t\":\"問\"},{\"d\":10,\"t\":\"答\"},{\"d\":11,\"t\":\"揀能信之機\"},{\"d\":11,\"t\":\"示夙根之厚\"},{\"d\":9,\"t\":\"明其福德\"},{\"d\":10,\"t\":\"正明其福\"},{\"d\":10,\"t\":\"釋顯其故\"},{\"d\":11,\"t\":\"正釋\"},{\"d\":11,\"t\":\"反顯\"},{\"d\":9,\"t\":\"結顯中道\"},{\"d\":10,\"t\":\"以雙離結成\"},{\"d\":10,\"t\":\"引筏喻顯義\"},{\"d\":9,\"t\":\"問釋證成\"},{\"d\":10,\"t\":\"舉如來果德問\"},{\"d\":10,\"t\":\"以法不可執釋\"},{\"d\":11,\"t\":\"明無定法\"},{\"d\":11,\"t\":\"釋應雙非\"},{\"d\":10,\"t\":\"引一切無為證\"},{\"d\":8,\"t\":\"校勝\"},{\"d\":9,\"t\":\"布施福多\"},{\"d\":10,\"t\":\"舉事設問\"},{\"d\":10,\"t\":\"答釋所以\"},{\"d\":9,\"t\":\"信經殊勝\"},{\"d\":9,\"t\":\"釋成經功\"},{\"d\":9,\"t\":\"結歸離相\"},{\"d\":7,\"t\":\"推闡無住以開解\"},{\"d\":8,\"t\":\"約果廣明\"},{\"d\":9,\"t\":\"泛論四果\"},{\"d\":10,\"t\":\"明初果離相\"},{\"d\":10,\"t\":\"明二果離相\"},{\"d\":10,\"t\":\"明三果離相\"},{\"d\":10,\"t\":\"明四果離相\"},{\"d\":9,\"t\":\"師資證成\"},{\"d\":10,\"t\":\"約當機無得證\"},{\"d\":11,\"t\":\"引佛說\"},{\"d\":11,\"t\":\"陳離相\"},{\"d\":11,\"t\":\"釋所以\"},{\"d\":12,\"t\":\"反顯\"},{\"d\":12,\"t\":\"正明\"},{\"d\":10,\"t\":\"約往因無得證\"},{\"d\":8,\"t\":\"約因詳顯\"},{\"d\":9,\"t\":\"約因心正顯\"},{\"d\":10,\"t\":\"先明嚴土不住\"},{\"d\":10,\"t\":\"顯成發無住心\"},{\"d\":10,\"t\":\"證以報身不住\"},{\"d\":9,\"t\":\"約經功校顯\"},{\"d\":10,\"t\":\"顯福德勝\"},{\"d\":11,\"t\":\"引河沙喻\"},{\"d\":11,\"t\":\"明寶施福\"},{\"d\":11,\"t\":\"顯持經勝\"},{\"d\":10,\"t\":\"顯勝所以\"},{\"d\":11,\"t\":\"明隨說福\"},{\"d\":11,\"t\":\"明盡持福\"},{\"d\":12,\"t\":\"正明盡持\"},{\"d\":12,\"t\":\"正明所以\"},{\"d\":13,\"t\":\"約成就正顯\"},{\"d\":13,\"t\":\"約熏習結成\"},{\"d\":8,\"t\":\"請示名持\"},{\"d\":9,\"t\":\"請\"},{\"d\":9,\"t\":\"示\"},{\"d\":10,\"t\":\"總示名持\"},{\"d\":11,\"t\":\"示能斷之名\"},{\"d\":11,\"t\":\"示持經之法\"},{\"d\":10,\"t\":\"詳明所以\"},{\"d\":11,\"t\":\"總標\"},{\"d\":11,\"t\":\"別詳\"},{\"d\":12,\"t\":\"示會歸性體\"},{\"d\":13,\"t\":\"示應離名字相持\"},{\"d\":13,\"t\":\"示應離言說相持\"},{\"d\":12,\"t\":\"示不壞假名\"},{\"d\":13,\"t\":\"示不著境相持\"},{\"d\":14,\"t\":\"問答\"},{\"d\":14,\"t\":\"正示\"},{\"d\":15,\"t\":\"不著微細相\"},{\"d\":15,\"t\":\"不著廣大相\"},{\"d\":13,\"t\":\"示不著身相持\"},{\"d\":10,\"t\":\"結顯持福\"},{\"d\":11,\"t\":\"約命施校\"},{\"d\":11,\"t\":\"明持福多\"},{\"d\":8,\"t\":\"成就解慧\"},{\"d\":9,\"t\":\"初當機讚勸\"},{\"d\":10,\"t\":\"標領解\"},{\"d\":10,\"t\":\"陳讚慶\"},{\"d\":10,\"t\":\"勸信解\"},{\"d\":11,\"t\":\"約現前勸\"},{\"d\":12,\"t\":\"明成就\"},{\"d\":12,\"t\":\"明實相\"},{\"d\":11,\"t\":\"約當來勸\"},{\"d\":12,\"t\":\"慶今勸後\"},{\"d\":13,\"t\":\"自慶\"},{\"d\":13,\"t\":\"廣勸\"},{\"d\":12,\"t\":\"釋顯其故\"},{\"d\":13,\"t\":\"正顯不著有\"},{\"d\":13,\"t\":\"轉顯不著空\"},{\"d\":13,\"t\":\"結顯名諸佛\"},{\"d\":9,\"t\":\"如來印闡\"},{\"d\":10,\"t\":\"印可\"},{\"d\":10,\"t\":\"闡義\"},{\"d\":11,\"t\":\"闡明觀行離相義務\"},{\"d\":12,\"t\":\"約般若明\"},{\"d\":12,\"t\":\"約餘度明\"},{\"d\":13,\"t\":\"正明\"},{\"d\":13,\"t\":\"引證\"},{\"d\":14,\"t\":\"引本劫事\"},{\"d\":14,\"t\":\"引多生事\"},{\"d\":11,\"t\":\"闡明說法真實義\"},{\"d\":12,\"t\":\"總結前文\"},{\"d\":13,\"t\":\"結成無住發心\"},{\"d\":14,\"t\":\"標結\"},{\"d\":14,\"t\":\"釋成\"},{\"d\":14,\"t\":\"反顯\"},{\"d\":13,\"t\":\"結成無住布施\"},{\"d\":14,\"t\":\"結不應\"},{\"d\":14,\"t\":\"結成應\"},{\"d\":15,\"t\":\"總標\"},{\"d\":15,\"t\":\"別明\"},{\"d\":12,\"t\":\"正明真實\"},{\"d\":13,\"t\":\"明說真實\"},{\"d\":13,\"t\":\"明法真實\"},{\"d\":12,\"t\":\"重以喻明\"},{\"d\":13,\"t\":\"喻住法之過\"},{\"d\":13,\"t\":\"喻不住之功\"},{\"d\":10,\"t\":\"結成\"},{\"d\":8,\"t\":\"極顯經功\"},{\"d\":9,\"t\":\"約生福顯\"},{\"d\":10,\"t\":\"立喻\"},{\"d\":10,\"t\":\"顯勝\"},{\"d\":11,\"t\":\"約福總示\"},{\"d\":12,\"t\":\"聞信即勝\"},{\"d\":12,\"t\":\"持說更勝\"},{\"d\":11,\"t\":\"舉要別明\"},{\"d\":12,\"t\":\"約教義明\"},{\"d\":12,\"t\":\"約緣起明\"},{\"d\":12,\"t\":\"約荷擔明\"},{\"d\":13,\"t\":\"正顯\"},{\"d\":13,\"t\":\"反顯\"},{\"d\":11,\"t\":\"結顯經勝\"},{\"d\":9,\"t\":\"約滅罪顯\"},{\"d\":10,\"t\":\"標輕賤之因\"},{\"d\":10,\"t\":\"明滅罪得福\"},{\"d\":9,\"t\":\"約供佛顯\"},{\"d\":10,\"t\":\"明供佛\"},{\"d\":10,\"t\":\"顯持經\"},{\"d\":9,\"t\":\"結成經功\"},{\"d\":10,\"t\":\"明難具說\"},{\"d\":10,\"t\":\"明不思議\"},{\"d\":6,\"t\":\"約心明無住以顯般若理體\"},{\"d\":7,\"t\":\"深觀無住以進修\"},{\"d\":8,\"t\":\"發心無法\"},{\"d\":9,\"t\":\"重請\"},{\"d\":9,\"t\":\"示教\"},{\"d\":9,\"t\":\"徵釋\"},{\"d\":9,\"t\":\"結成\"},{\"d\":8,\"t\":\"舉果明因\"},{\"d\":9,\"t\":\"詳明\"},{\"d\":10,\"t\":\"明果\"},{\"d\":11,\"t\":\"明無得而得\"},{\"d\":12,\"t\":\"舉問\"},{\"d\":12,\"t\":\"答釋\"},{\"d\":12,\"t\":\"印成\"},{\"d\":13,\"t\":\"如來印許\"},{\"d\":13,\"t\":\"反正釋成\"},{\"d\":14,\"t\":\"反釋\"},{\"d\":14,\"t\":\"正釋\"},{\"d\":11,\"t\":\"明法法皆如\"},{\"d\":12,\"t\":\"約名號明如\"},{\"d\":12,\"t\":\"約果德明如\"},{\"d\":13,\"t\":\"明無法\"},{\"d\":13,\"t\":\"明一如\"},{\"d\":12,\"t\":\"約諸法明如\"},{\"d\":13,\"t\":\"明即一切法\"},{\"d\":13,\"t\":\"明離一切相\"},{\"d\":12,\"t\":\"約報身明如\"},{\"d\":10,\"t\":\"明因\"},{\"d\":11,\"t\":\"正遣法執\"},{\"d\":12,\"t\":\"約度生遣\"},{\"d\":13,\"t\":\"標遣\"},{\"d\":13,\"t\":\"徵釋\"},{\"d\":14,\"t\":\"釋無法\"},{\"d\":14,\"t\":\"釋無我\"},{\"d\":12,\"t\":\"約嚴土遣\"},{\"d\":13,\"t\":\"標遣\"},{\"d\":13,\"t\":\"徵釋\"},{\"d\":11,\"t\":\"令達無我\"},{\"d\":12,\"t\":\"標示通達\"},{\"d\":12,\"t\":\"開佛知見\"},{\"d\":13,\"t\":\"明圓見\"},{\"d\":14,\"t\":\"明不執一\"},{\"d\":14,\"t\":\"明不執異\"},{\"d\":13,\"t\":\"明正知\"},{\"d\":14,\"t\":\"明心行叵得\"},{\"d\":15,\"t\":\"喻眾明知\"},{\"d\":16,\"t\":\"引喻\"},{\"d\":16,\"t\":\"悉知\"},{\"d\":15,\"t\":\"釋明非心\"},{\"d\":15,\"t\":\"結成叵得\"},{\"d\":14,\"t\":\"明諸法緣生\"},{\"d\":15,\"t\":\"約福報明無性\"},{\"d\":16,\"t\":\"明福德\"},{\"d\":17,\"t\":\"明福德因緣\"},{\"d\":17,\"t\":\"明緣會則生\"},{\"d\":16,\"t\":\"明報身\"},{\"d\":17,\"t\":\"明色身非性\"},{\"d\":17,\"t\":\"明相好非性\"},{\"d\":15,\"t\":\"約法施明體空\"},{\"d\":16,\"t\":\"明無法可說\"},{\"d\":17,\"t\":\"對機則說\"},{\"d\":18,\"t\":\"示說法無念\"},{\"d\":18,\"t\":\"釋有念即執\"},{\"d\":17,\"t\":\"本無可說\"},{\"d\":16,\"t\":\"明聞者性空\"},{\"d\":17,\"t\":\"請問\"},{\"d\":17,\"t\":\"遣執\"},{\"d\":17,\"t\":\"釋成\"},{\"d\":16,\"t\":\"明無法可得\"},{\"d\":17,\"t\":\"陳悟\"},{\"d\":17,\"t\":\"印釋\"},{\"d\":9,\"t\":\"結示\"},{\"d\":10,\"t\":\"直顯性體\"},{\"d\":10,\"t\":\"的示修功\"},{\"d\":10,\"t\":\"結無能所\"},{\"d\":8,\"t\":\"顯勝結勸\"},{\"d\":9,\"t\":\"引喻顯\"},{\"d\":9,\"t\":\"正結勸\"},{\"d\":7,\"t\":\"究極無住以成證\"},{\"d\":8,\"t\":\"明平等法界顯成法無我\"},{\"d\":9,\"t\":\"約度生明無聖凡\"},{\"d\":10,\"t\":\"明度無度念\"},{\"d\":11,\"t\":\"標示\"},{\"d\":11,\"t\":\"釋成\"},{\"d\":10,\"t\":\"明本無聖凡\"},{\"d\":9,\"t\":\"約性相明非一異\"},{\"d\":10,\"t\":\"總顯如義\"},{\"d\":10,\"t\":\"別遣情執\"},{\"d\":11,\"t\":\"遣取相明非一\"},{\"d\":12,\"t\":\"破解示遣\"},{\"d\":12,\"t\":\"說偈結成\"},{\"d\":11,\"t\":\"遣滅相明非異\"},{\"d\":12,\"t\":\"標示切誡\"},{\"d\":12,\"t\":\"結顯正義\"},{\"d\":9,\"t\":\"約不受福德結無我\"},{\"d\":10,\"t\":\"結無我\"},{\"d\":11,\"t\":\"明無我功勝\"},{\"d\":12,\"t\":\"引事\"},{\"d\":12,\"t\":\"較勝\"},{\"d\":11,\"t\":\"明由其不受\"},{\"d\":10,\"t\":\"明不著\"},{\"d\":11,\"t\":\"請明其義\"},{\"d\":11,\"t\":\"釋明不著\"},{\"d\":8,\"t\":\"明諸法空相結成法不生\"},{\"d\":9,\"t\":\"泯相入體\"},{\"d\":10,\"t\":\"約聖號明離去來\"},{\"d\":11,\"t\":\"斥凡情\"},{\"d\":11,\"t\":\"釋正義\"},{\"d\":10,\"t\":\"約塵界明離一多\"},{\"d\":11,\"t\":\"明微塵非多\"},{\"d\":12,\"t\":\"問微塵多否\"},{\"d\":12,\"t\":\"明多即非多\"},{\"d\":12,\"t\":\"釋其所以\"},{\"d\":11,\"t\":\"明世界非一\"},{\"d\":12,\"t\":\"明非界名界\"},{\"d\":12,\"t\":\"釋一即非一\"},{\"d\":12,\"t\":\"示本離言說\"},{\"d\":10,\"t\":\"約我見明離亦離\"},{\"d\":11,\"t\":\"問答明義\"},{\"d\":11,\"t\":\"釋成其故\"},{\"d\":9,\"t\":\"結成不生\"},{\"d\":10,\"t\":\"正明不生\"},{\"d\":10,\"t\":\"不生亦無\"},{\"d\":2,\"t\":\"流通分\"},{\"d\":3,\"t\":\"示勸流通\"},{\"d\":4,\"t\":\"示流通益\"},{\"d\":5,\"t\":\"引財施\"},{\"d\":5,\"t\":\"明法施\"},{\"d\":4,\"t\":\"示流通法\"},{\"d\":5,\"t\":\"直指本性\"},{\"d\":5,\"t\":\"觀法緣生\"},{\"d\":3,\"t\":\"正結流通\"}]",
    "var React=require(\"react\");\r\nvar treetoc=require(\"ksana2015-treetoc\");\r\nvar TreeToc=treetoc.component;\r\nvar toc=require(\"./jwl-toc\");\r\nvar createRandomLink=function() {\r\n\tfor (var i=0;i<toc.length;i++) {\r\n\t\tvar r=Math.random();\r\n\t\tif (r>0.5) {\r\n\t\t\ttoc[i].links=[r.toString().substr(2,5)];\r\n\t\t}\r\n\t\tif (r>0.75) {\r\n\t\t\ttoc[i].links.push((1-r).toString().substr(2,5));\r\n\t\t}\r\n\t}\r\n}\r\ntreetoc.buildToc(toc);\r\ncreateRandomLink();\r\nvar LinkCompononent = React.createClass({displayName: \"LinkCompononent\",\r\n\tclick:function(e) {\r\n\t\te.stopPropagation();\r\n\t}\r\n\t,render :function() {\r\n\t\treturn React.createElement(\"a\", {onClick: this.click, key: \"k\"+this.props.key, className: \"nodelink\"}, this.props.caption, \" \")\r\n\t}\r\n});\r\n\r\nvar onNode=function(cur) {\r\n\tif (cur.links) { \r\n\t\treturn cur.links.map(function(link,idx){return React.createElement(LinkCompononent, {caption: link, key: idx})});\r\n\t}\r\n\telse return null;\r\n}\r\nvar maincomponent = React.createClass({displayName: \"maincomponent\",\r\n  getInitialState:function() {\r\n    return {result:[],tofind:\"君子\"};\r\n  },\r\n  expandAll:function(){\r\n\tfor (var i=0;i<toc.length;i++) toc[i].o=true;\r\n\tthis.forceUpdate();\r\n  }\r\n  ,closeAll:function(){\r\n\tfor (var i=0;i<toc.length;i++) toc[i].o=false;\r\n\tthis.forceUpdate();\r\n  }\r\n  ,render: function() {\r\n    return React.createElement(\"div\", null, \r\n    React.createElement(\"button\", {onClick: this.expandAll}, \"打開全部\"), React.createElement(\"button\", {onClick: this.closeAll}, \"關閉全部\"), \r\n      React.createElement(TreeToc, {data: toc, opts: {multiselect:true,editable:true,tocstyle:\"ganzhi\", onNode:onNode}})\r\n    );\r\n  }\r\n});\r\nmodule.exports=maincomponent;"
  ]
}